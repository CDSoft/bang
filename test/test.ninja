# Ninja file generated by bang (https://cdelord.fr/bang)

######################################################################
# This file is generated by bang for test purpose.
# Section comments can have multiple lines.
######################################################################

######################################################################
# Atomic variables
######################################################################

var1 = string
var2 = 42
var3 = true
# v1        = $var1
# vars.var1 = string
# v2        = $var2
# vars.var2 = 42
# v3        = $var3
# vars.var3 = true

######################################################################
# Compound variables
######################################################################

var4 = string 42 true foo bar
# v4        = $var4
# vars.var4 = string 42 true foo bar

######################################################################
# Rules
######################################################################

rule cc
  description = CC $out
  command = gcc $cflags -c $in -o $out

# cc = "cc"

######################################################################
# Build statements
######################################################################

build foo1.o: cc foo1.c foo.h
build foo2.o | a.log b.log: cc foo2.c foo.h | a.dat b.dat || x.dat
  myvar = myval
# o1 = "foo1.o"
# o2 = "foo2.o"
build all: phony foo1.c foo2.c
build foo3.o foo4.o foo5.o: cc foo3.c
# o3 = {"foo3.o", "foo4.o", "foo5.o"}

######################################################################
# Inheritance
######################################################################

rule r1
  command = cmd1

build b1 | o1: r1 | i1 i2 i3

rule r2
  command = cmd2

build b2 | o2: r2 | i4 i5

######################################################################
# Embedded rules
######################################################################

rule special_target_txt_11780f2a6c4ef519
  description = a rule embedded inside a build statement
  command = cat $in > $out
  depfile = $out.d

build special_target.txt | hidden_output: special_target_txt_11780f2a6c4ef519 file1.txt file2.txt | hidden_input

######################################################################
# Pools
######################################################################

pool link_pool
  depth = 4

rule link
  pool = link_pool

build link1: link
build link2: link
  pool =

######################################################################
# Accumulations
######################################################################

# xs = {"item1", "item2", "item3"}

######################################################################
# ls test
######################################################################

# test/bar
# test/foo
# test/new_file.txt
# test/test.hlp
# test/test.lua
# test/test.ninja

######################################################################
# ls test/*
######################################################################

# test/new_file.txt
# test/test.hlp
# test/test.lua
# test/test.ninja

######################################################################
# ls test/*.lua
######################################################################

# test/test.lua

######################################################################
# ls test/**
######################################################################

# test/bar
# test/foo
# test/foo/f1.c
# test/foo/f2.lua
# test/foo/sub
# test/foo/sub/f3.c
# test/foo/sub/f4.lua
# test/new_file.txt
# test/test.hlp
# test/test.lua
# test/test.ninja

######################################################################
# ls test/**.c
######################################################################

# test/foo/f1.c
# test/foo/sub/f3.c

######################################################################
# ls test/**.lua
######################################################################

# test/foo/f2.lua
# test/foo/sub/f4.lua
# test/test.lua

######################################################################
# additional file
######################################################################

# .build/test/tmp/new_file.txt should be created

######################################################################
# Command line arguments
######################################################################

# The command line arguments are: {"arg1", "arg2", "-x=y"}

######################################################################
# Installation
######################################################################

prefix = $$HOME/.local/pub/bang_test

rule install-bin_78c1c207b965c154
  description = INSTALL $in to bin
  command = install -v -D -t $${PREFIX:-$prefix}/bin $in

build install-bin: install-bin_78c1c207b965c154 foo1.bin foo2.bin foo3.bin

rule install-lib_14cef9983f74141e
  description = INSTALL $in to lib
  command = install -v -D -t $${PREFIX:-$prefix}/lib $in

build install-lib: install-lib_14cef9983f74141e foo1.lib
build install: phony install-bin install-lib

######################################################################
# Clean
######################################################################

rule clean-_builddir_e7c9fd42467ee7fb
  description = CLEAN $builddir
  command = rm -rf $builddir/*

build clean-_builddir: clean-_builddir_e7c9fd42467ee7fb

rule clean-_builddir_foo_f5937d122e3fb85e
  description = CLEAN $builddir/foo
  command = rm -rf $builddir/foo

build clean-_builddir_foo: clean-_builddir_foo_f5937d122e3fb85e

rule clean-foo_bar_3ddfce6c5a3c647b
  description = CLEAN foo/bar
  command = rm -rf foo/bar

build clean-foo_bar: clean-foo_bar_3ddfce6c5a3c647b
build clean: phony clean-_builddir clean-_builddir_foo clean-foo_bar

######################################################################
# Help
######################################################################

rule help
  description = $in
  command = cat $in

build help: help test.hlp
