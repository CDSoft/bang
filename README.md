Bang
====

Bang is a [Ninja](https://ninja-build.org) file generator scriptable in [LuaX](https://cdelord.fr/luax).

Compilation
===========

Bang is written in LuaX.
It can be compiled with [Ninja](https://ninja-build.org) and [LuaX](https://github.com/CDSoft/luax).

## LuaX

``` sh
$ git clone https://github.com/CDSoft/luax
$ cd luax
$ make install  # this should install LuaX to ~/.local/bin
```

## Bang

``` sh
$ git clone https://github.com/CDSoft/bang
$ cd bang
$ ./install.sh  # this should compile bang with Ninja and install it to ~/.local/bin
```

Usage
=====

```
$ bang -h
Usage: bang [-h] [-o output] [<input>]

Ninja file generator

Arguments:
   input                 Lua script (default: build.lua)

Options:
   -h, --help            Show this help message and exit.
   -o output             Output file (default: build.ninja)

For more information, see https://github.com/CDSoft/bang
```

* `bang` reads `build.lua` and produces `build.ninja`.
* `bang input.lua -o output.ninja` reads `input.lua` and produces `output.ninja`.

## Comments

`bang` can add comments to the Ninja file:

``` lua
comment "This is a comment added to the Ninja file"
```

`section` adds comments separated by horizontal lines:

``` lua
section [[
A large title
that can run on several lines
]]
```

## Variables

`var` adds a new variable definition:

``` lua
var "varname" "string value"
var "varname" (number)
var "varname" {"word_1", "word_2", ...} -- will produce `varname = word_1 word_2 ...`
```

## Rules

`rule` adds a new rule definition:

``` lua
rule "rule_name" {
    description = "...",
    command = "...",
    ...
}
```

Variable values can be strings or lists of strings.
Lists of strings are flattened and concatenated (separated with spaces).

## Build statements

`build` adds a new build statement:

``` lua
build "outputs" "inputs"
```

generates the build statement `build outputs: inputs`.
The first word of `inputs` shall be the rule name applied by the build statement.

The build statement can be added some variable definitions:

``` lua
build "outputs" "inputs" {
    varname = "value",
    ...
}
```

There are reserved variable names for bang to specify implicit inputs and outputs and dependency orders:

``` lua
build "outputs" "inputs" {
    implicit_out = "implicit outputs",
    implicit_in = "implicit inputs",
    order_only_deps = "order-only dependencies",
    ...
}
```

## Default targets

`default` adds targets to the default target:

``` lua
default "target1"
default {"target2", "target3"}
```

Example
=======

The Ninja file of bang ([`build.ninja`](build.ninja)) is generated by `bang` from [`build.lua`](build.lua).

License
=======

    This file is part of bang.

    bang is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    bang is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with bang.  If not, see <https://www.gnu.org/licenses/>.

    For further information about bang you can visit
    https://cdelord.fr/bang

